# KinoRezervacija
Windows Forms Project by: Luka Jovanovski, Ivana Girazova and Jana Micevska

##1. Опис на апликацијата и функционалности

Апликацијата што ја развиваме служи како систем за управување со филмови и билети за тие филмови во кинотеки. 
Корисници на овој систем се вработените во кинотеки. 
Тие имаат можност да водат запис за филмовите кои се прикажуваат во нивните кино сали, и да вршат наплата на билети, храна и пијалоци.
Инспирација за ваков систем  добивме од постоечките системи на Cineplexx и други познати кинотеки, но имплементацијата е направена целосно од наша страна.

##2. Упатство за користењe

###2.1 Почетен прозорец
На левата страна од почетниот прозорец се прикажани сите кино сали и филмовите кои се прикажуваат во нив. 
Во долниот дел од прозорецот има копчиња за: додавање на филм, бришење на филм и додавање на сала. 
Во десниот дел се прикажани деталите за одбраниот филм, а под тоа се копчињата за билет и за храна и пијалоци, како и копче за наплата. 
Во горниот лев дел од прозорецот се наоѓа мени, преку кое може да се зачуваат сите податоци и внесени филмови преку клик на File->Save. 
Доколку е потребно да се отвори претходно зачувана верзија, истото може да се направи со клик на File->Open.

![image](https://user-images.githubusercontent.com/88928070/131256029-1b1a6309-5e13-4420-b816-4513fdeb743f.png)

###2.2 Филтрирање и сортирање на филмови
Над листата со кино сали, се наоѓаат полиња за филтрирање и сортирање на филмови. 
Филмовите може да се филтрираат според жанр, и може да се избере: акција, комедија, драма, фантазија и документарец. 
Сортирањето може да биде според: наслов, жанр, режисер или цена, а исто така може да се избере дали филмовите да се прикажуваат во опаѓачки или растечки редослед.

###2.3 Додавање и бришење на филм
При клик на копчето Add a Movie, се отвара нов прозорец во кој може да се внесат податоци за нов филм кој ќе се прикажува.
Податоците што се пополнуваат се: наслов, режисер, жанр, цена на билет и сала во која ќе се прикажува филмот. 
Може да се одбере и претходно внесен филм во друга сала, наместо да се внесуваат повторно податоците за истиот.
Со клик на копчето Add Movie во тој прозорец, филмот ќе се додаде на соодветното место во листата со кино сали. 
За бришење на одреден филм, се селектира соодветниот филм и се притиска на копчето Remove Selected Movie.

![image](https://user-images.githubusercontent.com/88928070/131256180-6b194210-1c65-434d-892b-5364f00c9af1.png)

###2.4 Додавање на сала
При клик на копчето Add A Hall се отвара нов прозорец каде можеме да додадеме нова сала и да ја одбереме нејзината големина 
(мала-20 седишта, средна-30 седишта, голема-50 седишта).

![image](https://user-images.githubusercontent.com/88928070/131256240-8588ff12-2302-4bf9-91df-9d535e5a6ddd.png)

###2.5 Избирање на храна и пијалоци
Со клик на копчето Food and Drinks се отвара нов прозорец каде може да се одбере тип на мени, храна и пијалок, како и додатоци. 
По избор на посакуваните продукти, треба да се притиснат копчињата add food и add drink соодветно, 
при што истите се префрлаат во левиот долен дел од прозорецот каде е пресметана цената заедно со одреден попуст кој се добива. 
По финална проверка, се притиска на копчето >> со што сите продукти ќе се додадат на вкупната сметка. 

![image](https://user-images.githubusercontent.com/88928070/131256331-6fccfd42-20f0-4924-b02d-8c42c5b1caa9.png)
![image](https://user-images.githubusercontent.com/88928070/131256339-4a38544e-11e6-4a16-8595-f9e5f4788dd1.png)

###2.6 Избирање на седишта
Ако се одбере филм и се притисне на кошчето Buy Ticket, се отвара нов прозорец каде може да се изберат седишта(со селектирање на седиштето), 
и по клик на копчето Buy, оваа цена се додава на вкупната сметка.

![image](https://user-images.githubusercontent.com/88928070/131256400-caccc6d2-f20c-4e1c-8201-8a86697965e3.png)

###2.7 Наплата
При клик на копчето Bill во долниот десен дел од прозорецот, се прикажува вкупната цена која треба да се плати, 
со детали за продуктите кои се наплаќаат од делот за билети и храна и пијалоци.

![image](https://user-images.githubusercontent.com/88928070/131256461-d3008a5c-010c-44e0-9797-85ea02cb1530.png)

##3. Претставување на проблемот

###3.1 Податочни структури
Најважните податоци поврзани со киното и филмовите се чуваат во класите Theater, Hall и Movie.

####3.1.1
```class Theater```
Чува листа од сите кино сали во кои или моментално се емитува некаков филм или пак се празни. Исто така ги чува сите филмови кои некогаш биле емитувани, а не се моментално емитувани, за повторна употреба.

```
  public BindingList<Hall> Halls { get; set; }
  public BindingList<Hall> _halls { get; set; }
  ```
  Има две листи , _halls ги чува сите сали со сите нивни атрибути додека листата Halls ги чува само тековните филтрирани и сортирани кино сали.
  
  ```
  public static Comparison<Movie> DefaultComparator = Movie.Comparator.CompareByName;
  ```
  Исто така се чува компаратор за класата Movie што ќе и означи кој ќе е прeдефинираниот атрибут по кој што ќе се сортираат филмовите.  

####3.1.2
```class Hall```
Чува податоци за големината на салата како и кој филм се прикажува во моментот во таа сала. Исто така се чуваат информации за седиштата од таа сала: кои се веќе купени а кои се слободни.
Големината на салата се чува во enum.
```
    enum HallType
    {
        Large,
        Medium,
        Small
    }
```
####3.1.3
```class Movie```
Чува податоци за филм како име, режисер, цена...

```
        public class Comparator
        {
            public static Comparison<Movie> CompareByPrice = (Movie m1, Movie m2) => m1.Price.CompareTo(m2.Price);

            public static Comparison<Movie> CompareByName = delegate (Movie object1, Movie object2)
            {
                return object1.Name.CompareTo(object2.Name);
            };

            public static Comparison<Movie> CompareByGenre = delegate (Movie object1, Movie object2)
            {
                return object1.Genre.CompareTo(object2.Genre);
            };

            public static Comparison<Movie> CompareByRegisseur = (Movie m1, Movie m2) => m1.Regisseur.CompareTo(m2.Regisseur);
        }
```
Ги чува сите компаратори за класата Movie во посебна класа и за нејзината употреба само треба да се употреби 
```
Movie.Comparator.CompareByName; //пример за користење на компараторот за споредба според име
```
За полесно да се достапи до компараторите преку Combobox тие се ставени во Dictionary каде што клучот им е името а во вредноста се наоѓа самиот компаратор
```
        public static Dictionary<string, Comparison<Movie>> SortType = new Dictionary<string, Comparison<Movie>>()
        {
            { "Title", Comparator.CompareByName },
            { "Genre", Comparator.CompareByGenre },
            { "Price", Comparator.CompareByPrice },
            { "Regisseur", Comparator.CompareByRegisseur }
        };
```
Класата ```class MovieComparator : IComparer<Movie>``` е потребна за компараторите да се претворат во IComparer и да може да се употребат во c# linq
```
                Halls = new BindingList<Hall>(Halls
                    .OrderBy(x => x.CurrentMoviePlaying == null)
                    .ThenBy(x => x.CurrentMoviePlaying, new MovieComparator(Movie.SortType.GetValueOrDefault(Type, Movie.DefaultComparator)))
                    .ThenBy(x => x.HallNumber).ToList());
```


####3.1.4 Менија
```
    abstract class Menu
```
За купувањето јадење и пиење се користат DefaultMenu, LoveMenu и NoMenu кои наследуваат од апстрактната класа Menu.Тие чуваат или ограничен број на јадење и пиење со попуст или  пак неограничен број на јадење и пиење без попуст. Истите се чуваат во листа од Menu, односно тука е искористен полиморфизам.

####3.1.5 Јадење и пиење
Самите јадења и пиења можат да имаат мали додатоци како на пример хот-дог со кечап/мајонез или и двете, или спрајт со дополнителни коцки мраз. За да се постигне оваа функционалност искористен е [decorator pattern](https://en.wikipedia.org/wiki/Decorator_pattern).

```
    interface IExtra
```
Интерфејсот IExtra во него чува име и цена и од него наследуваат класите Food и FoodAddition.Во FoodAddition се чува дополнителен property
```        public IExtra FoodDrink { get; set; }```
Со него чуваме претходен додаток и со комбинација на Food i повеќе FoodAddition всушност се добива структура каде што само го знаеме последниот FoodAddition и рекурзивно самиот тој си ја пресметува цената на сите додатоци кои се поврзани со него.

```
IExtra Popcorn = new Food("Popcorn",50);
IExtra Ketchup = new FoodAddition("Ketchup",10, Popcorn);
IExtra Senf = new FoodAddition("Senf",15, Ketchup);
Console.Writeline(Senf.Price) //75
```

####3.1.6
За чување на податоци поврзани со **карта за кино и сметка** се користат класите MovieTicket и Bill. MovieTicket содржи информации за филмот како и во која сала се наоѓа и бројот на седиште, додека класата Bill содржи листа од MovieTicket како и листа од Menu и повеќе атрибути за форматот на печатење.
